<%- include('header.html', { title: "Groups" }) %>

<p>Upload a Gradebook CSV from MyLO to list group allocations. Roles and group-channels can then be generated.</p>
<p>(This can be automated when MyLO Integration is enabled)</p>
<form method="post" enctype='multipart/form-data'>

    <div><input type="file" name="csv" style="width:500px" /></div>
        
    <div><input class="btn" type="submit" value="Upload"/></div>

</form>

<%
if (locals.groups != undefined)
{
    %>
    <p>
        <%=Object.values(locals.groups).length%> groups.
    </p>
    <table>
        <thead>
            <tr>
                <th>Group</th>
                <th>Members</th>
            </tr>
        </thead>
        <tbody>
            <%
            var groupNames = Object.keys(locals.groups);
            groupNames.sort(function(a, b) {
                return a.localeCompare(b, undefined, {
                  numeric: true,
                  sensitivity: 'base'
                });
              });
            groupNames.forEach(groupName => 
            {
                var members = locals.groups[groupName];
                %>
                <tr>
                    <td valign="top"><%=groupName%></td>
                    <td><%=members.length%> Members</td>
                </tr>
                <%
            });
            %>
        </tbody>
    </table>
    <%
} 
%>


<%- include('footer.html') %>