<%- include('header.html') %>

<h2>Invites</h2>
<p>Associate a role with an invite. Users who use that invite will automatically be assigned that role.</p>
<table id="guilds">
  <% invites.forEach(function(uses, code){ %>
    <tr>
        <td><a href="https://discord.gg/<%= code %>">https://discord.gg/<%= code %></a></td>
        <td>
            <%- include("subViews/select.html", { 
                id:code, 
                data:rolesList, 
                defaultText: "--- Assign Role ---",
                selected: appliedRolesList[code],
                onChange:"applyRole(value, id);" }) %>
        </td>
    </tr>
  <% }) %>
  <tr>
      <td><a href="generate">Generate New Invite</a></td>
  </tr>
</table>
<script>
    function applyRole(role, id)
    {
        $.ajax({
            url:"",
            method:"post",
            data:{
                role:role,
                id:id,
            },
            complete:(XPathResult) => document.location.reload()
        })
    }
</script>

<%- include('footer.html') %>