<%- include('header.html') %>

<nav>
    <ul>
        <% if (locals.lectureChannel) { %>
            <li><a href="clearpoll/">Clear Current Poll</a></li>
            <li><a href="pollSchedule/">Scheduled Polls</a></li>
        <% } %>
        <li><a href="text/input/">Lecture Full-Screen Texts</a></li>
        <li><a href="attendance/">Attendance</a></li>
        <li><a href="analytics/">Analytics</a></li>
        <li><a href="analytics/timeGraph">Analytics - Graphs</a></li>
        <li><a href="awards/">Awards</a></li>
        <li><a href="leaderboard/">Awards Leaderboard</a></li>
        <li><a href="invites/">Configure Invites</a></li>
    </ul>
</nav>

<h3>OBS Pages</h3>
<nav>
    <ul>
        <% if (locals.lectureChannel) { %>
            <li><a href="poll/">Poll Widget</a></li>
        <% } %>
        <li><a href="text/">Lecture Full-Screen Text Widget</a></li>
        <li><a href="analytics/obs">Top Posters and Award Leaderboard Widget</a></li>
    </ul>
</nav>

<h3>Role Set Up</h3>
<p>Admin/Staff Role:
    <select id="setAdminRoleID">
        <option>Please Select Role</option>
        <% 
        var roles = guild.roles.cache.sort((a,b) => a.position - b.position);
        roles.forEach(function(role)
        { 
            //console.log(role);
            %><option value="<%= role.id %>"
                <% if (locals.adminRole && role.id == locals.adminRole.id) { %>selected<% } %>>
                <%= role.name %>
            </option><%
        }) %>
    </select></p>
<script>
    $("#setAdminRoleID").on("change", (e) =>
    {
        document.location.href = "?setAdminRoleID="+$("#setAdminRoleID").val();
    });
</script>
<p>Current Students Role:
    <select id="setStudentRoleID">
        <option>Please Select Role</option>
        <% 
        var roles = guild.roles.cache.sort((a,b) => a.position - b.position);
        roles.forEach(function(role)
        { 
            //console.log(role);
            %><option value="<%= role.id %>"
                <% if (locals.studentRole && role.id == locals.studentRole.id) { %>selected<% } %>>
                <%= role.name %>
            </option><%
        }) %>
    </select></p>
<script>
    $("#setStudentRoleID").on("change", (e) =>
    {
        document.location.href = "?setStudentRoleID="+$("#setStudentRoleID").val();
    });
</script>

<h3>Channel Set Up</h3>
<p>Lecture Channel:  
    <select id="setLectureChannel">
        <option>Please Select Channel</option>
        <%
        var categoryChannels = guild.channels.cache.filter(channel => channel.type === "GUILD_CATEGORY").sort((a,b) => a.position - b.position);
        categoryChannels.forEach(cat => { %>
            <optgroup label="<%= cat.name %>">
                <% var sortedChannels = cat.children.sort((a,b) => a.position - b.position);
                sortedChannels.forEach(function(channel)
                { 
                    %><option value="<%= channel.id %>"
                        <% if (locals.lectureChannel && channel.id == locals.lectureChannel.id) { %>selected<% } %>>
                        <%= channel.name %>
                    </option><%
                }) %>
            </optgroup>
        <% }); %>
    </select></p>
<script>
    $("#setLectureChannel").on("change", (e) =>
    {
        document.location.href = "?setLectureChannelID="+$("#setLectureChannel").val();
    });
</script>


<p>Awards Channel:  
    <select id="setAwardChannel">
        <option>Please Select Channel</option>
        <%
        var categoryChannels = guild.channels.cache.filter(channel => channel.type === "GUILD_CATEGORY").sort((a,b) => a.position - b.position);
        categoryChannels.forEach(cat => { %>
            <optgroup label="<%= cat.name %>">
                <% var sortedChannels = cat.children.sort((a,b) => a.position - b.position);
                sortedChannels.forEach(function(channel)
                { 
                    %><option value="<%= channel.id %>"
                        <% if (locals.awardChannel && channel.id == locals.awardChannel.id) { %>selected<% } %>>
                        <%= channel.name %>
                    </option><%
                }) %>
            </optgroup>
        <% }); %>
    </select></p>
<script>
    $("#setAwardChannel").on("change", (e) =>
    {
        document.location.href = "?setAwardChannelID="+$("#setAwardChannel").val();
    });
</script>

<p>Off-topic Channel:  
    <select id="setOffTopicChannel">
        <option>Please Select Channel</option>
        <%
        var categoryChannels = guild.channels.cache.filter(channel => channel.type === "GUILD_CATEGORY").sort((a,b) => a.position - b.position);
        categoryChannels.forEach(cat => { %>
            <optgroup label="<%= cat.name %>">
                <% var sortedChannels = cat.children.sort((a,b) => a.position - b.position);
                sortedChannels.forEach(function(channel)
                { 
                    %><option value="<%= channel.id %>"
                        <% if (locals.offTopicChannel && channel.id == locals.offTopicChannel.id) { %>selected<% } %>>
                        <%= channel.name %>
                    </option><%
                }) %>
            </optgroup>
        <% }); %>
    </select></p>
<script>
    $("#setOffTopicChannel").on("change", (e) =>
    {
        document.location.href = "?setOffTopicChannelID="+$("#setOffTopicChannel").val();
    });
</script>

<%- include('footer.html') %>
